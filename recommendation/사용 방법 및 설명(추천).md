# 서울시 대학 근처 업종 추천 및 과잉 분석 프로그램

이 프로그램은 서울시 대학 주변의 음식점 데이터를 분석하여 특정 대학에서 창업을 추천할 만한 업종과 과잉 분포한 업종을 도출합니다. 분석 과정은 Spark를 활용하여 HDFS에 저장된 데이터를 처리하며, 다음과 같은 주요 단계를 포함합니다.

---

## 프로그램 개요

### 주요 기능
1. **추천 업종 도출**: 타겟 대학에서 평균 대비 부족한 업종을 추천합니다.
2. **과잉 업종 분석**: 평균 대비 과잉 분포된 업종을 식별합니다.
3. **결과 출력**: 추천 및 과잉 업종을 출력합니다.

<br>

### 입력 파일
프로그램 실행에 필요한 CSV 파일 및 경로:
- **university_info.csv**  
  위치: `hdfs:///user/maria_dev/term_project/output/`  
  내용: 대학명 및 학생 밀도 정보


- **university_business_count.csv**  
  위치: `hdfs:///user/maria_dev/term_project/output/`  
  내용: 대학별 음식점 수 데이터


- **classification_codes.csv**  
  위치: `hdfs:///user/maria_dev/term_project/output/`  
  내용: 업종 분류 코드 및 명칭 데이터

<br>

## 코드 상세 설명

### 주요 함수 설명

#### `createSparkSession`
Spark 세션을 생성합니다.  
- **리턴값**: SparkSession 객체

<br>

#### `univ_info_load`
대학교 정보 CSV 파일을 로드하고 열 이름을 통일합니다.  
- **리턴값**: DataFrame (`대학교`, `밀도(학생/km²)` 포함)

<br>

#### `univ_count_load`
대학별 사업체 수 데이터 로드.  
- **리턴값**: DataFrame (`대학교`, `count` 포함)

<br>

#### `join_on_univ`
`univ_info_load`와 `univ_count_load` 데이터를 `대학교`를 기준으로 결합하며, 학생 밀도 대비 사업체 수를 계산합니다.  
- **리턴값**: DataFrame (`count_per_density` 포함)

<br>

#### `group_by_codes`
업종 중분류, 소분류별로 그룹화하고 `count_per_density`의 평균을 계산합니다.  
- **리턴값**: DataFrame (`avg_count_per_density` 포함)

<br>

#### `recommend`
타겟 대학에서 업종별 `count_per_density`와 평균값의 차이를 계산하여 추천/과잉 업종 데이터를 생성합니다.  
- **리턴값**: DataFrame (`difference_from_avg`, `current_count` 포함)

<br>

#### `match_code_and_name`
추천 결과를 업종 명칭 데이터와 매칭하여 사람이 읽기 쉽게 변환합니다.  
- **리턴값**: DataFrame (`recommendation`, `type` 포함)

<br>

#### `print_categorized_results`
추천 업종과 과잉 업종을 출력합니다.  
- **리턴값**: 없음

<br>

#### `print_description`
프로그램 설명과 입력 파일 요구 사항을 출력합니다.  
- **리턴값**: 없음

<br>

## 사용법

### 실행 명령어
```bash
spark-submit recommend.py <대학교명>
```

<br>

### 주요 파라미터
criterion_value

추천/과잉의 기준 퍼센트 차이를 설정합니다.

기본값: 0.5 (50%)

<br>

### 출력
- 추천 업종: 평균 대비 부족한 업종을 출력

- 과잉 업종: 평균 대비 과잉 분포한 업종을 출력

<br>

### 실행 흐름
1. 입력 파일 로드

2. 학생 밀도 대비 업종 수 계산

3. 평균값과 비교하여 차이 도출

4. 업종 분류 코드와 매칭

5. 추천 및 과잉 결과 출력

<br>

---

### 실행 예시

```bash
spark-submit recommend.py 명지대학교

    서울시 대학 근처 음식점 평균 개수를 기반으로
        - 타겟 대학에서 창업을 추천할 만한 카테고리를 추천
        - 과잉 분포하고 있는 카테고리도 제공

    필요한 CSV 파일 및 위치:

        1. university_info.csv
           위치: hdfs:///user/maria_dev/term_project/output/
           내용: 대학교 정보 (대학명, 밀도(학생/km²) 등)

        2. university_business_count.csv
            위치: hdfs:///user/maria_dev/term_project/output/
            내용: 대학별 사업체 수 데이터

        3. classification_codes.csv
            위치: hdfs:///user/maria_dev/term_project/output/
            내용: 상권 업종 분류 코드 및 명칭

추천/과잉 기준: 0.5

========== [추천 업종] ==========
서양식 > 파스타/스테이크
현재 1개 운영 중
평균보다 91.9% 적음

구내식당·뷔페 > 구내식당
현재 1개 운영 중
평균보다 91.5% 적음

한식 > 소고기 구이/찜
현재 1개 운영 중
평균보다 91.3% 적음

주점 > 일반 유흥 주점
현재 2개 운영 중
평균보다 91.2% 적음

서양식 > 기타 서양식 음식점
현재 1개 운영 중
평균보다 89.5% 적음

한식 > 냉면/밀면
현재 1개 운영 중
평균보다 88.9% 적음

한식 > 해산물 구이/찜
현재 2개 운영 중
평균보다 88.2% 적음

한식 > 기타 한식 음식점
현재 1개 운영 중
평균보다 86.5% 적음

동남아시아 > 베트남식 전문
현재 3개 운영 중
평균보다 85.0% 적음

한식 > 국수/칼국수
현재 4개 운영 중
평균보다 83.8% 적음

서양식 > 경양식
현재 10개 운영 중
평균보다 83.2% 적음

주점 > 생맥주 전문
현재 6개 운영 중
평균보다 81.6% 적음

일식 > 일식 면 요리
현재 2개 운영 중
평균보다 81.5% 적음

일식 > 일식 카레/돈가스/덮밥
현재 2개 운영 중
평균보다 80.3% 적음

기타 간이 > 그 외 기타 간이 음식점
현재 4개 운영 중
평균보다 79.1% 적음

주점 > 요리 주점
현재 24개 운영 중
평균보다 77.8% 적음

한식 > 돼지고기 구이/찜
현재 17개 운영 중
평균보다 76.5% 적음

기타 간이 > 아이스크림/빙수
현재 2개 운영 중
평균보다 76.3% 적음

일식 > 일식 회/초밥
현재 13개 운영 중
평균보다 76.3% 적음

기타 간이 > 피자
현재 11개 운영 중
평균보다 75.0% 적음

한식 > 곱창 전골/구이
현재 4개 운영 중
평균보다 74.9% 적음

구내식당·뷔페 > 뷔페
현재 1개 운영 중
평균보다 74.4% 적음

기타 간이 > 떡/한과
현재 4개 운영 중
평균보다 74.0% 적음

한식 > 국/탕/찌개류
현재 10개 운영 중
평균보다 73.6% 적음

중식 > 중국집
현재 11개 운영 중
평균보다 72.9% 적음

기타 간이 > 토스트/샌드위치/샐러드
현재 3개 운영 중
평균보다 72.9% 적음

한식 > 백반/한정식
현재 55개 운영 중
평균보다 72.8% 적음

비알코올 > 카페
현재 67개 운영 중
평균보다 70.3% 적음

기타 간이 > 빵/도넛
현재 18개 운영 중
평균보다 68.3% 적음

한식 > 횟집
현재 6개 운영 중
평균보다 67.9% 적음

한식 > 닭/오리고기 구이/찜
현재 5개 운영 중
평균보다 67.6% 적음

기타 간이 > 치킨
현재 21개 운영 중
평균보다 61.0% 적음

기타 간이 > 김밥/만두/분식
현재 38개 운영 중
평균보다 54.8% 적음


========== [과잉 업종] ==========
과잉 업종이 없습니다.
```
